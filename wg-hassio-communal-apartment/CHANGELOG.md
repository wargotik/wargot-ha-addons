# Changelog

Все значимые изменения в этом проекте будут документироваться в этом файле.

Формат основан на [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),
и этот проект придерживается [Semantic Versioning](https://semver.org/lang/ru/).

## [0.3.6] - 2025-01-XX

### Changed
- Удалён параметр `currency` из конфигурации add-on'а
- На UI вместо названия валюты отображается иконка `mdi:cash`
- Суммы отображаются в числовом формате без указания валюты

### Removed
- Удалён API endpoint `/api/config`
- Удалена логика загрузки и валидации валюты из конфигурации
- Удалена функция `load_config()` и `validate_currency()` из `main.py`

## [0.3.5] - 2025-01-XX

### Changed
- Поле `currency` возвращено к текстовому вводу с подсказкой о формате ISO 4217
- Добавлена ссылка на официальный список кодов валют ISO 4217 в описании поля
- Добавлена валидация кода валюты при загрузке конфигурации (формат: 3 заглавные буквы)
- При невалидном коде валюты используется значение по умолчанию (EUR) с предупреждением в логах

## [0.3.4] - 2025-01-XX

### Changed
- Поле `currency` в конфигурации изменено на выпадающий список с вариантами валют
- Добавлены варианты: Евро, Доллар, Российский рубль, Украинская гривна, Злотый, Белорусский рубль
- По умолчанию установлено значение "Евро" (EUR)

## [0.3.3] - 2025-01-XX

### Added
- Добавлен файл CHANGELOG.md для отслеживания изменений проекта

## [0.3.2] - 2025-01-XX

### Added
- Добавлено использование параметра `currency` из конфигурации add-on'а на UI
- Добавлен API endpoint `/api/config` для получения конфигурации
- Суммы на UI теперь отображаются в валюте, указанной в конфигурации

## [0.3.1] - 2025-01-XX

### Changed
- Автоматическая подстановка текущей даты при открытии модального окна добавления оплаты
- Период стал необязательным полем и автоматически рассчитывается на основе даты оплаты
- Период перенесён в правую колонку (необязательные поля)
- Поле "Заметки" изменено с input на textarea
- Поле "Дата оплаты" размещено выше поля "Сумма" в форме

### Fixed
- Backend автоматически вычисляет период из даты оплаты, если период не указан

## [0.3.0] - 2025-01-XX

### Changed
- Восстановлен веб-сервер для UI (без внешних HTTP-запросов)
- Восстановлены настройки ingress для доступа к веб-интерфейсу

### Removed
- Удалены внешние HTTP-запросы к сторонним сайтам
- Удалён модуль `ozon_api.py`
- Удалён модуль `storage.py`

## [0.2.9] - 2025-01-XX

### Removed
- Удалён параметр `site` из конфигурации и его использование
- Удалён `aiohttp` из зависимостей (позже восстановлен для веб-сервера)

## [0.2.6] - 2025-01-XX

### Added
- Добавлены Home Assistant сенсоры для интеграции с панелью "Энергия"
- Добавлен расчёт и сохранение `unit_price` (стоимость за единицу) при добавлении оплаты
- Добавлено отображение `unit_price` в UI списка платежей
- Добавлен параметр `currency` в конфигурацию add-on'а (по умолчанию `EUR`)

### Fixed
- Исправлены сенсоры для корректной работы с панелью "Энергия" Home Assistant
- Исправлен доступ к полям `sqlite3.Row` объектов

## [0.2.1] - 2025-01-XX

### Added
- Добавлены поля "Предыдущее показание счётчика" и "Текущее показание счётчика"
- Добавлен автоматический расчёт объёма на основе показаний счётчика
- Добавлено сохранение объёма в базу данных

### Changed
- Переработан UI модального окна добавления оплаты: два столбца (обязательные слева, необязательные справа)
- Поле "Тип оплаты" теперь использует константы (Электроэнергия, Газ, Вода) вместо базы данных
- Обновлены иконки: `mdi:cash-multiple` для заголовка, `mdi:pencil-plus` для кнопки добавления

### Removed
- Удалена кнопка "Парсить все товары" и связанный функционал

## [0.2.0] - 2025-01-XX

### Changed
- Проект переименован с "Ozon" на "Коммунальные платежи"
- Изменена структура базы данных: добавлены таблицы `payments` и `payment_types`
- UI изменён: "Товары из базы" → "Оплаты", "Добавить товар" → "Добавить оплату"

### Added
- Добавлена таблица `payment_types` с полями: `id`, `name`, `system_name`, `description`, `is_active`, `is_system`
- Добавлена таблица `payments` с полями: `id`, `payment_type_id`, `amount`, `payment_date`, `period`, `receipt_number`, `payment_method`, `notes`, `created_at`, `updated_at`

## [0.1.x] - 2025-01-XX

### Added
- Начальная версия add-on для отслеживания товаров Ozon
- Базовая структура add-on с веб-интерфейсом
- Интеграция с базой данных SQLite
- Функционал парсинга страниц товаров Ozon

---

[0.3.6]: https://github.com/wargotik/wargot-ha-addons/compare/v0.3.5...v0.3.6
[0.3.5]: https://github.com/wargotik/wargot-ha-addons/compare/v0.3.4...v0.3.5
[0.3.4]: https://github.com/wargotik/wargot-ha-addons/compare/v0.3.3...v0.3.4
[0.3.3]: https://github.com/wargotik/wargot-ha-addons/compare/v0.3.2...v0.3.3
[0.3.2]: https://github.com/wargotik/wargot-ha-addons/compare/v0.3.1...v0.3.2
[0.3.1]: https://github.com/wargotik/wargot-ha-addons/compare/v0.3.0...v0.3.1
[0.3.0]: https://github.com/wargotik/wargot-ha-addons/compare/v0.2.9...v0.3.0
[0.2.9]: https://github.com/wargotik/wargot-ha-addons/compare/v0.2.6...v0.2.9
[0.2.6]: https://github.com/wargotik/wargot-ha-addons/compare/v0.2.1...v0.2.6
[0.2.1]: https://github.com/wargotik/wargot-ha-addons/compare/v0.2.0...v0.2.1
[0.2.0]: https://github.com/wargotik/wargot-ha-addons/compare/v0.1.x...v0.2.0

