#include <tunables/global>

profile alarmme flags=(attach_disconnected,mediate_deleted) {
  #include <abstractions/base>
  
  # Network access
  network,
  capability net_bind_service,
  
  # File system - full access to data and app directories
  /data/** rw,
  
  # Application files - CRITICAL: Python needs to read directory and import modules
  /app/ r,
  /app r,
  /app/** rmix,
  /app/*.py rmix,
  /app/**/*.py rmix,
  /app/__pycache__/** rmix,
  /app/**/__pycache__/** rmix,
  
  # Config files
  /config.json r,
  /data/options.json r,
  
  # Python interpreter
  /usr/bin/python* ix,
  /usr/local/bin/python* ix,
  
  # Python libraries - broad access
  /usr/local/lib/** rmix,
  /usr/lib/** rmix,
  /lib/** rm,
  /lib64/** rm,
  
  # Tini init system
  /usr/bin/tini ix,
  /sbin/tini ix,
  
  # Process information
  owner @{PROC}/[0-9]*/** r,
  /proc/** r,
  
  # Logging and temp files
  /var/log/** w,
  /tmp/** rw,
  /var/tmp/** rw,
  
  # System config (minimal)
  /etc/passwd r,
  /etc/group r,
  /etc/nsswitch.conf r,
  /etc/hosts r,
  /etc/resolv.conf r,
  
  # System info (read-only)
  /sys/** r,
  
  # Deny sensitive files only
  deny /etc/shadow r,
  deny /root/** r,
}
